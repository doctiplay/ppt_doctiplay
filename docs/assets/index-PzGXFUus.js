(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&l(n)}).observe(document,{childList:!0,subtree:!0});function d(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(e){if(e.ep)return;e.ep=!0;const t=d(e);fetch(e.href,t)}})();console.log("Doctiplay Presentation Initialized");function I(){const i=document.getElementById("main"),o=document.getElementById("indicator");i&&o&&i.addEventListener("scroll",()=>{const n=i.scrollTop,r=i.scrollHeight-i.clientHeight,s=r>0?n/r*100:0;o.style.height=s+"%"});const d=document.querySelectorAll(".reveal"),l=new IntersectionObserver(n=>{n.forEach(r=>{r.isIntersecting&&r.target.classList.add("active")})},{threshold:.1,root:i});d.forEach(n=>l.observe(n)),document.querySelectorAll("#slide-1 .reveal").forEach(n=>{n.classList.add("active")}),i&&window.addEventListener("keydown",n=>{const r=i.clientHeight;(n.key==="ArrowDown"||n.key==="PageDown")&&(n.preventDefault(),i.scrollBy({top:r,left:0,behavior:"smooth"})),(n.key==="ArrowUp"||n.key==="PageUp")&&(n.preventDefault(),i.scrollBy({top:-r,left:0,behavior:"smooth"}))}),document.querySelectorAll('a[href^="#"]').forEach(n=>{n.addEventListener("click",r=>{const s=n.getAttribute("href"),p=document.querySelector(s);p&&i&&(r.preventDefault(),p.scrollIntoView({behavior:"smooth"}))})});const t=document.getElementById("pdf-export-btn");t&&t.addEventListener("click",()=>{document.querySelectorAll(".reveal").forEach(r=>r.classList.add("active")),setTimeout(()=>{window.print()},300)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{I(),T()}):(I(),setTimeout(T,100));const c={fc:90,spo2:99,nibpSys:100,nibpDia:60,targetFc:90,targetSpo2:99,targetNibpSys:100,targetNibpDia:60};window.scopeAction=function(i){const o=document.getElementById("scope-toast"),l=new Date().toLocaleTimeString("fr-FR");let e="";if(i==="o2"){c.targetSpo2=98,e="O₂ administré";let t=c.spo2>95?95:c.spo2;P("val-spo2",t,98,2e3),c.spo2=98}else i==="remplissage"?(c.targetNibpSys=110,c.targetNibpDia=70,e="Remplissage initié",M(c.nibpSys,c.nibpDia,110,70),c.nibpSys=110,c.nibpDia=70):i==="insuline"&&(c.targetFc=85,e="Insulinothérapie débutée",P("val-fc",c.fc,85,2e3),c.fc=85);o&&(o.innerText=`[${l}] ${e}`,o.classList.add("show"),setTimeout(()=>o.classList.remove("show"),3e3))};function P(i,o,d,l,e){const t=document.getElementById(i);if(!t)return;t.classList.add("pulse-anim"),setTimeout(()=>t.classList.remove("pulse-anim"),300);const n=d-o;let r=o;const s=d>o?1:-1,p=Math.abs(Math.floor(l/(n===0?1:n)));if(n===0)return;const u=setInterval(function(){r+=s,t.innerText=r,r==d&&clearInterval(u)},Math.max(p,50))}function M(i,o,d,l){const e=document.getElementById("val-nibp");if(!e)return;e.classList.add("pulse-anim"),setTimeout(()=>e.classList.remove("pulse-anim"),300);let t=i,n=o;const r=setInterval(()=>{let s=!1;t!=d&&(t+=t<d?1:-1,s=!0),n!=l&&t%2===0&&(n+=n<l?1:-1,s=!0),e.innerText=`${t}/${n}`,s||clearInterval(r)},100)}function T(){const i=document.getElementById("ecg-canvas"),o=document.getElementById("pleth-canvas");if(!i||!o){setTimeout(T,500);return}function d(){const u=i.parentElement,m=o.parentElement,a=u.getBoundingClientRect(),f=m.getBoundingClientRect(),v=a.width||u.clientWidth,g=a.height||u.clientHeight,h=f.width||m.clientWidth,y=f.height||m.clientHeight;v>0&&g>0&&(i.width=v,i.height=g),h>0&&y>0&&(o.width=h,o.height=y)}d(),setTimeout(d,100),setTimeout(d,500),setTimeout(d,1e3),setTimeout(d,2e3),window.addEventListener("resize",d);const l=i.getContext("2d"),e=o.getContext("2d");let t=1.4;function n(u){const a=u%800;let f=0;return a>180&&a<210&&(f-=90*Math.sin((a-180)/30*Math.PI)),a>300&&a<450&&(f-=12*Math.sin((a-300)/150*Math.PI)),a>50&&a<150&&(f-=4*Math.sin((a-50)/100*Math.PI)),f}function r(u){const a=u%800;let f=0;return a<300?f-=Math.sin(a/300*Math.PI)*45:f-=Math.cos((a-300)/500*Math.PI/2)*45,f}let s=0;function p(u){const m=i.height,a=m/2+25,f=o.height,v=f/2+15,g=14;s+g<i.width&&(l.clearRect(s,0,g,m),e.clearRect(s,0,g,f));const h=20;l.beginPath(),l.strokeStyle="#00ff00",l.lineWidth=1.5;const y=a+n((s-t)*h),L=a+n(s*h);l.moveTo(s-t,y),l.lineTo(s,L),l.stroke(),e.beginPath(),e.strokeStyle="#00ffff",e.lineWidth=1.5;const S=v+r((s-t)*h),B=v+r(s*h);if(e.moveTo(s-t,S),e.lineTo(s,B),e.stroke(),s+=t,s>=i.width&&(s=0,l.clearRect(0,0,t+10,m),e.clearRect(0,0,t+10,f)),c.fc){const E=document.getElementById("val-fc"),b=document.getElementById("val-spo2"),w=document.getElementById("val-nibp");E&&E.innerText!=c.fc&&(E.innerText=c.fc),b&&b.innerText!=c.spo2&&(b.innerText=c.spo2),w&&w.innerText!=`${c.nibpSys}/${c.nibpDia}`&&(w.innerText=`${c.nibpSys}/${c.nibpDia}`)}requestAnimationFrame(p)}requestAnimationFrame(p)}
